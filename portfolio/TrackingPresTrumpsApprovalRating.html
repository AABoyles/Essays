<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Tracking President Trump’s Approval Rating</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
<script src="site_libs/readthedown-0.1/readthedown.js"></script>
<script src="site_libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="site_libs/plotlyjs-1.16.3/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.16.3/plotly-latest.min.js"></script>
<script src="site_libs/plotly-binding-4.5.6/plotly.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #dddddd; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { color: #800000; } /* DataType */
code > span.dv { color: #0000ff; } /* DecVal */
code > span.bn { color: #0000ff; } /* BaseN */
code > span.fl { color: #800080; } /* Float */
code > span.ch { color: #ff00ff; } /* Char */
code > span.st { color: #dd0000; } /* String */
code > span.co { color: #808080; font-style: italic; } /* Comment */
code > span.al { color: #00ff00; font-weight: bold; } /* Alert */
code > span.fu { color: #000080; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #ff0000; font-weight: bold; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #ff00ff; } /* SpecialChar */
code > span.vs { color: #dd0000; } /* VerbatimString */
code > span.ss { color: #dd0000; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #808080; font-style: italic; } /* Documentation */
code > span.an { color: #808080; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #808080; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #808080; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="site_libs/style.css" type="text/css" />

</head>

<body>


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Anthony A. Boyles</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Portfolio</a>
</li>
<li>
  <a href="../essays/">Essays</a>
</li>
<li>
  <a href="../code.html">Code</a>
</li>
<li>
  <a href="../about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../README.html">Meta</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="content" data-toggle="wy-nav-shift">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<nav id="nav-top" role="navigation" aria-label="top navigation">
    <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
</nav>

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
</ul>
</div>

<div id="header">
<h1 class="title">Tracking President Trump’s Approval Rating</h1>
</div>


<div id="table-of-contents">
    <h2><a href="#content">Tracking President Trump’s Approval Rating</a></h2>
    <div id="text-table-of-contents">
      <ul>
      <li><a href="#setting-a-prior">Setting a Prior</a></li>
      <li><a href="#getthing-the-data">Getthing the Data</a></li>
      <li><a href="#real-forecasting">Real Forecasting</a><ul>
      <li><a href="#scoring-the-prophet">Scoring the Prophet</a></li>
      <li><a href="#crunching-out-an-estimate">Crunching out an Estimate</a></li>
      </ul></li>
      <li><a href="#forecasting-non-derived-signals">Forecasting non-derived Signals</a><ul>
      <li><a href="#scoring-the-prophet-round-2">Scoring the Prophet, Round 2</a></li>
      </ul></li>
      <li><a href="#the-inside-view">The Inside View</a></li>
      </ul>
    </div>
</div>

<div id="main">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;knitr&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;lubridate&#39;</span>)
knitr::opts_chunk$<span class="kw">set</span>(<span class="dt">message =</span> F, <span class="dt">warning =</span> F, <span class="dt">error =</span> F)
<span class="kw">source</span>(<span class="st">&#39;../infobox.R&#39;</span>)
<span class="kw">infobox</span>(<span class="kw">list</span>(
  <span class="st">`</span><span class="dt">First Published</span><span class="st">`</span> =<span class="st"> &quot;2017-03-16&quot;</span>,
  <span class="st">`</span><span class="dt">Last Updated</span><span class="st">`</span> =<span class="st"> </span><span class="kw">today</span>()
))</code></pre></div>
<div class="infobox">
<table class="infoboxtable">
<tbody>
<tr>
<td>
<b>First Published</b>
</td>
<td>2017-03-16</td>
</tr>
<tr>
<td>
<b>Last Updated</b>
</td>
<td>2017-03-24</td>
</tr>
</tbody>
<tfoot></tfoot>
</table>
</div>
<p>As part of its <a href="https://www.gjopen.com/challenges/13-the-first-100-days">First 100 Days Challenge</a>, the <a href="https://www.washingtonpost.com/news/monkey-cage/">Monkey Cage blog</a> asked the <a href="https://www.gjopen.com/">Good Judgement Open</a>, “What will President Trump’s approval rating be on April 28, 2017?” From the <a href="https://www.gjopen.com/questions/384-what-will-gallup-report-president-trump-s-net-approval-rating-to-be-on-28-april-2017">question information</a>:</p>
<blockquote>
<p>President-elect Trump’s net approval rating has improved since his election in November (<a href="http://www.gallup.com/poll/201617/gallup-daily-trump-job-approval.aspx">Gallup</a>). This question will be resolved by subtracting President Trump’s disapproval rating from his approval rating using the “Gallup Daily” Trump job approval rating. Gallup is tracking President Trump’s job approval ratings here: (<a href="http://www.gallup.com/poll/201617/gallup-daily-trump-job-approval.aspx">Gallup</a>).</p>
</blockquote>
<div id="setting-a-prior" class="section level1">
<h1>Setting a Prior</h1>
<p>For an uninformed prior, up to 100% of the population can approve of the President, and likewise 100% can disapprove. This means that valid net approval ratings span from -100 (everyone disapproves) to 100 (everyone approves). The span of -15 to 15 covers 30 of those 200 points, so if we assume that net approval ratings are pulled from a uniform distribution, we should expect to fall in that range with a frequency of around <span class="math inline">\(30/200=.15\)</span>.</p>
<p>However, this is a poor estimate for a lot of reasons. For one, in general, about half the country is going to disapprove of the President and about half the country will approve of the President. So the distribution of net approvals should have central tendency metrics (mean, mode) fairly close to 0. So, a better prior would come from a normal distribution with a mean of zero.</p>
<p>For another significant refinement to this conception of the distribution of approval ratings, day-to-day ratings seem to be correlated. For example, here are <a href="http://www.gallup.com/interactives/185273/presidential-job-approval-center.aspx">Barack Obama’s approval ratings</a> over his two terms:</p>
<div class="figure">
<img src="http://anthony.boyles.cc/imgs/Screenshot_2017-03-16_13-35-53.png" />

</div>
<p>(Note that these are <em>approval</em> ratings, not <em>net approval</em> ratings. Gallup only launched the daily net approval rating for the Trump administration. However, since the net approval is the difference between Approval and a metric that is necessarily inversely proportional to it, looking at raw Approval ratings is still pretty instructive.)</p>
<p>As we can see, there are long term curves in the approval rating, but lots of day-to-day noise. For an even more dramatic perspective on this phenomenon, check out <a href="http://www.gallup.com/interactives/185273/presidential-job-approval-center.aspx">George W. Bush’s approval ratings</a> over his two terms:</p>
<div class="figure">
<img src="http://anthony.boyles.cc/imgs/Screenshot_2017-03-16_13-36-24.png" />

</div>
<p>Here we can see President Bush enjoying a modest honeymoon period, followed by a huge jump on 9-11. From there, his approval began to degrade again until March 1, 2003, when he launched the US invasion of Iraq, causing another small spike in popularity. Everything else was a long, slow roll down the hill. We can point out these phenomenal changes because they were unusual. From day-to-day, the changes in approval don’t swing widely across the range of possible approval estimates. If you want to predict the President’s approval rating tomorrow, a decent strategy is to just guess what it is today.</p>
<p>So, what is President Trump’s approval rating today?</p>
</div>
<div id="getthing-the-data" class="section level1">
<h1>Getthing the Data</h1>
<p>Let’s parse the data directly from the Gallup Visualization’s data feed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;tidyverse&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;xml2&#39;</span>)

<span class="co"># Please excuse this XML hacking.</span>
viz &lt;-<span class="st"> </span><span class="kw">read_xml</span>(<span class="st">&#39;http://www.gallup.com/viz/v1/xml/6b9df319-97d6-4664-80e1-ea7fe4672aca/POLLFLEXCHARTVIZ/TRUMPJOBAPPR201617.aspx&#39;</span>) %&gt;%
<span class="st">  </span><span class="kw">xml_child</span>(<span class="dv">3</span>) %&gt;%
<span class="st">  </span><span class="kw">xml_child</span>() %&gt;%
<span class="st">  </span><span class="kw">xml_child</span>(<span class="dv">3</span>) %&gt;%
<span class="st">  </span><span class="kw">xml_children</span>() %&gt;%
<span class="st">  </span><span class="kw">as_list</span>()

disapproval &lt;-<span class="st"> </span>viz %&gt;%
<span class="st">  </span><span class="kw">lapply</span>(function(el){el$p}) %&gt;%
<span class="st">  </span><span class="kw">flatten</span>() %&gt;%
<span class="st">  </span><span class="kw">as.double</span>()

approval &lt;-<span class="st"> </span>viz %&gt;%
<span class="st">  </span><span class="kw">lapply</span>(function(el){el[<span class="dv">2</span>]$p}) %&gt;%
<span class="st">  </span><span class="kw">flatten</span>() %&gt;%
<span class="st">  </span><span class="kw">as.double</span>()

n &lt;-<span class="st"> </span><span class="kw">length</span>(disapproval)

date &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="st">&quot;17/01/21&quot;</span>) +<span class="st"> </span><span class="dv">1</span>:n

ratings &lt;-<span class="st"> </span><span class="kw">tibble</span>(date, approval, disapproval) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">net_approval =</span> approval -<span class="st"> </span>disapproval)

ratings %&gt;%<span class="st"> </span><span class="kw">tail</span>(<span class="dv">1</span>) %&gt;%<span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="right">approval</th>
<th align="right">disapproval</th>
<th align="right">net_approval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2017-03-22</td>
<td align="right">39</td>
<td align="right">56</td>
<td align="right">-17</td>
</tr>
</tbody>
</table>
<p>Not great. If we guess that the President’s approval rating will be what it is today, it’s definitely below the -15:15 band. How’s he been doing?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;plotly&#39;</span>)
<span class="kw">plot_ly</span>(ratings, <span class="dt">x =</span> ~date, <span class="dt">y =</span> ~net_approval, <span class="dt">name =</span> <span class="st">&quot;Net Approval&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="dt">mode =</span> <span class="st">&#39;lines&#39;</span>)</code></pre></div>
<div id="htmlwidget-67e02abb4e1c30796c02" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-67e02abb4e1c30796c02">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"date"},"yaxis":{"domain":[0,1],"title":"net_approval"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"modeBarButtonsToRemove":["sendDataToCloud"]},"data":[{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22"],"y":[0,-1,1,1,-3,-8,-9,-7,-8,-9,-9,-9,-6,-11,-10,-12,-9,-9,-10,-12,-15,-14,-14,-13,-14,-18,-15,-14,-11,-12,-10,-9,-9,-12,-13,-12,-12,-9,-8,-8,-8,-7,-6,-8,-11,-12,-10,-5,-4,-9,-16,-14,-11,-13,-15,-21,-16,-17,-15,-17],"name":"Net Approval","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y"}],"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p>Not good at all. It seems President Trump has skipped the honeymoon and dived straight into the -10’s doldrums which plague Presidents late in their terms.</p>
<p>To take a simple frequentist approach, let’s just count the number of times his approval rating has fallen in each band.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;pander&#39;</span>)

ratings %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">band =</span> <span class="kw">if_else</span>(net_approval &gt;=<span class="st"> </span>-<span class="dv">15</span>, <span class="st">&quot;middle&quot;</span>, <span class="st">&quot;lower&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">select</span>(-date, -approval, -disapproval, -net_approval) %&gt;%
<span class="st">  </span><span class="kw">table</span>() %&gt;%
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:22%;">
<colgroup>
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">lower</th>
<th align="center">middle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">6</td>
<td align="center">54</td>
</tr>
</tbody>
</table>
<p>OK, since we only drop into the lower band thrice, let’s say that lower-band probability is something like 0.05 and the middle-band probability is 0.88, and the high-band probability is very small.</p>
<p>I strongly dislike <a href="http://lesswrong.com/lw/mp/0_and_1_are_not_probabilities/">probability estimates of 0 and 1</a>, so instead of saying the high-band probability is zero, I’m going to invoke the <a href="https://en.wikipedia.org/wiki/Rule_of_three_(statistics)">rule of three</a>. The probability that the net approval is more than +15 is probably less than 0.05. This is curious, as it implies the low-band and high-band probabilities are similar, despite the fact we’ve observed low-band outcomes and have not observed high-band outcomes. So, in the interest of preserving my tiny bias away from certainty, I’ll call the high-band probability 1% and deduct it from the middle-band.</p>
<p>At this point, this is probably a pretty good basis for a GJO forecast. But can we do better?</p>
</div>
<div id="real-forecasting" class="section level1">
<h1>Real Forecasting</h1>
<p>The “forecast” we computed above is a simple estimating of a probability distribution over outcomes for a single point. In Data Science Parlance, however, “forecasting” refers to something related but more general. Forecasting typically means to infer trends based solely on cyclicalities in the data. Data we care about tends to vary regularly across times of day, day of week, month of year, etc. If there’s a long-term trend in these data, we may be able to catch wind of it by pitting our net approval data against an off-the-shelf forecasting tool. There’s a whole class of interesting statistical tools to do this (<a href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average">ARIMA</a> is prehaps the most recognizable). Since it’s shiny and new, let’s try out Facebook’s whiz-bang new time-series tool, <a href="https://facebookincubator.github.io/prophet/">Prophet</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;prophet&quot;</span>)

temp &lt;-<span class="st"> </span>ratings %&gt;%
<span class="st">  </span><span class="kw">select</span>(-approval, -disapproval) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">rename</span>(
    <span class="dt">ds =</span> date,
    <span class="dt">y =</span> net_approval
  )

m &lt;-<span class="st"> </span><span class="kw">prophet</span>(temp, <span class="dt">yearly.seasonality =</span> F, <span class="dt">mcmc.samples =</span> <span class="dv">100</span>)

future &lt;-<span class="st"> </span><span class="kw">make_future_dataframe</span>(m, <span class="dt">periods =</span> <span class="dv">100</span>-n)

forecast &lt;-<span class="st"> </span><span class="kw">predict</span>(m, future)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_ly</span>(forecast, <span class="dt">x =</span> ~ds, <span class="dt">y =</span> ~yhat_upper, <span class="dt">name =</span> <span class="st">&quot;Upper bound&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="dt">mode =</span> <span class="st">&#39;lines&#39;</span>) %&gt;%
<span class="st">  </span><span class="kw">add_lines</span>(<span class="dt">y =</span> ~yhat, <span class="dt">name =</span> <span class="st">&quot;Estimate&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">add_lines</span>(<span class="dt">y =</span> ~yhat_lower, <span class="dt">name =</span> <span class="st">&quot;Lower Bound&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">add_lines</span>(<span class="dt">data =</span> temp, <span class="dt">y =</span> ~y, <span class="dt">name =</span> <span class="st">&quot;Actual&quot;</span>)</code></pre></div>
<div id="htmlwidget-05831e89c30fcaaa346d" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-05831e89c30fcaaa346d">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"ds"},"yaxis":{"domain":[0,1],"title":"yhat_upper"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"modeBarButtonsToRemove":["sendDataToCloud"]},"data":[{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22","2017-03-23","2017-03-24","2017-03-25","2017-03-26","2017-03-27","2017-03-28","2017-03-29","2017-03-30","2017-03-31","2017-04-01","2017-04-02","2017-04-03","2017-04-04","2017-04-05","2017-04-06","2017-04-07","2017-04-08","2017-04-09","2017-04-10","2017-04-11","2017-04-12","2017-04-13","2017-04-14","2017-04-15","2017-04-16","2017-04-17","2017-04-18","2017-04-19","2017-04-20","2017-04-21","2017-04-22","2017-04-23","2017-04-24","2017-04-25","2017-04-26","2017-04-27","2017-04-28","2017-04-29","2017-04-30","2017-05-01"],"y":[-1.2282678043511,-2.94606374404167,-1.25888287179237,-1.3750328397647,-2.6545473271315,-2.60963603261577,-4.06551093229454,-2.57721882229515,-3.93934016071685,-2.56023121252932,-2.78358274110282,-3.41536630696091,-2.84574264853602,-5.07525774213824,-3.13479095244831,-4.89490064124016,-3.5653623764158,-3.61675408467031,-4.19795350273794,-4.54667091659867,-5.87588571084702,-4.09698080869225,-6.16636453503143,-4.63062052020045,-4.2893251228192,-5.26149943810119,-5.604605963868,-6.95639874465788,-5.08402365960998,-7.20611764576561,-5.41941159149808,-5.43040080525058,-6.19981639255924,-6.46669481264492,-8.08442614598889,-5.98777823641707,-7.81911075235944,-6.52015435920746,-6.69257607039819,-7.1745643383145,-7.63476022809168,-9.07717693268891,-6.86493205983326,-8.89409915553621,-7.41585314577655,-7.44869810079028,-8.15399125151252,-8.32117296723834,-9.93264868806972,-7.83124807939393,-9.69571863270767,-8.4762018423071,-8.61006627140489,-9.07579949352971,-9.38995825985588,-11.1476961642498,-9.0182745301572,-10.7535092909685,-9.12444352540067,-9.30580773839307,-9.87823469043198,-10.2056849822257,-11.5461701182171,-9.75607326465117,-11.682795514307,-9.9859109687671,-10.3957439688933,-10.970866264371,-11.2589251602409,-12.7838165725319,-10.8385302348826,-12.6508268080042,-11.190261571255,-11.1014666265209,-11.9144332598026,-12.1559597571311,-13.349862147543,-11.9480960809641,-13.3283218487026,-12.5157258052651,-12.2545905298976,-12.6389104637987,-13.0794049516718,-14.6448022038833,-12.7457158901728,-14.4291758341516,-12.952766892566,-13.0970343008384,-13.9603133105884,-13.3266574815524,-15.672535608995,-13.43339238921,-15.2413829359801,-14.147092580857,-14.1693865289785,-14.6101684703384,-14.6885969621779,-16.5837413473321,-14.6273283150487,-16.1711813482762],"name":"Upper bound","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y"},{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22","2017-03-23","2017-03-24","2017-03-25","2017-03-26","2017-03-27","2017-03-28","2017-03-29","2017-03-30","2017-03-31","2017-04-01","2017-04-02","2017-04-03","2017-04-04","2017-04-05","2017-04-06","2017-04-07","2017-04-08","2017-04-09","2017-04-10","2017-04-11","2017-04-12","2017-04-13","2017-04-14","2017-04-15","2017-04-16","2017-04-17","2017-04-18","2017-04-19","2017-04-20","2017-04-21","2017-04-22","2017-04-23","2017-04-24","2017-04-25","2017-04-26","2017-04-27","2017-04-28","2017-04-29","2017-04-30","2017-05-01"],"y":[-5.45819483286125,-7.12721604354648,-5.79839111870606,-5.74968109577167,-6.45310021851626,-6.6906833305041,-8.25003050132748,-6.4422012511936,-8.11109457827552,-6.78196540745122,-6.73301023916876,-7.43618421655281,-7.67354647016223,-9.23267278261024,-7.42469713036771,-9.09344405534198,-7.76434923397523,-7.71539741660914,-8.41853446829166,-8.65589013545992,-10.2150285014126,-8.40703560168057,-10.0757046322659,-8.74652752732793,-8.69736143235972,-9.40023315229648,-9.63732348771582,-11.1959837672861,-9.38751278117145,-11.0556679847078,-9.72597705271585,-9.67640114430492,-10.3789543815573,-10.6157385626686,-12.1742868026225,-10.3657599199966,-12.033955614586,-10.7043729510315,-10.6549332914748,-11.3576721839172,-11.5946512573358,-13.1533943895974,-11.345069860002,-13.0134679076254,-11.6841581757339,-11.6349914478428,-12.337958538822,-12.5751442452873,-14.1340660446991,-12.3258565784248,-13.994369689366,-12.6650366647835,-12.6158466441989,-13.3187857692853,-13.5559435098597,-15.1148653092734,-13.3066558429989,-14.9751689539426,-13.6458359293597,-13.596645908778,-14.2995850338613,-14.536742774432,-16.0956645738457,-14.2874551075731,-15.9559682185191,-14.6266351939344,-14.5774451733505,-15.2803842984374,-15.5175420390098,-17.0764638384226,-15.2682543721468,-16.9367674830893,-15.6074344585091,-15.558244437923,-16.2611835630135,-16.4983413035862,-18.057263102995,-16.249053636721,-17.9175667476659,-16.5882337230787,-16.5390437024962,-17.241982827582,-17.4791405681557,-19.0380623675692,-17.2298529012951,-18.8983660122392,-17.56903298766,-17.5198429670746,-18.2227820921618,-18.4599398327335,-20.0188616321435,-18.2106521658696,-19.8791652768126,-18.5498322522296,-18.5006422316471,-19.2035813567323,-19.4407390973058,-20.9996608967185,-19.191451430443,-20.8599645413859],"name":"Estimate","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y"},{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22","2017-03-23","2017-03-24","2017-03-25","2017-03-26","2017-03-27","2017-03-28","2017-03-29","2017-03-30","2017-03-31","2017-04-01","2017-04-02","2017-04-03","2017-04-04","2017-04-05","2017-04-06","2017-04-07","2017-04-08","2017-04-09","2017-04-10","2017-04-11","2017-04-12","2017-04-13","2017-04-14","2017-04-15","2017-04-16","2017-04-17","2017-04-18","2017-04-19","2017-04-20","2017-04-21","2017-04-22","2017-04-23","2017-04-24","2017-04-25","2017-04-26","2017-04-27","2017-04-28","2017-04-29","2017-04-30","2017-05-01"],"y":[-9.51111319260913,-11.4094586023096,-10.1280054519914,-9.90359264018833,-10.6242324054225,-10.9893186411507,-12.670438712401,-10.7466716593056,-12.2340924464282,-10.7775948133435,-10.8742421412654,-11.6558170587451,-11.4491700371596,-13.5386973501609,-11.5285225191494,-13.2274936316612,-11.8132216415553,-11.5486134032141,-12.6128432589802,-12.6693316124246,-14.3281401797018,-12.7202600225912,-14.2226391604622,-12.8896037213394,-12.5967865589492,-13.6786850353333,-13.8452855435604,-15.5289130896268,-13.4588207433769,-15.2178790830821,-14.1639671702786,-13.7221380233587,-14.2457395186909,-14.8521289647691,-16.3567968631694,-14.4775546342146,-16.1301174263092,-14.7389956229539,-15.0558654412232,-15.54261652231,-15.7720271722018,-17.1330670969518,-15.4426032918513,-17.0934462613679,-15.8956354688635,-15.4951650997232,-16.3718031960755,-16.8834344779264,-18.5150025641216,-16.5064163513804,-18.120594368787,-16.8948881589575,-17.0202424447306,-17.1918723917121,-17.64519181793,-19.503561799356,-17.3834557949399,-19.1343259487431,-18.1551796052025,-17.6516235430712,-18.4566062471772,-18.9687446932988,-20.2417697955267,-18.4691678985944,-20.2562875815132,-19.1089569136104,-18.7392288473515,-19.5636638081484,-19.7468006512596,-21.3084527978478,-19.7102672693162,-21.6996370843651,-19.9802134093503,-20.02298596691,-20.6773728362658,-21.1230035088359,-22.4794649602562,-20.5381017887774,-22.1134843399026,-20.7292098493316,-21.1035477778708,-21.8769561057682,-21.9863614550385,-23.8473433255853,-21.8727170048345,-23.7646262418311,-22.181143270266,-21.9994053480551,-22.7452603581423,-23.024865687943,-24.5622341746907,-22.5695757262973,-24.6089064039519,-22.9927460916118,-23.1627227173874,-23.8896337703435,-24.3235801501706,-25.9986056572468,-24.0384072631278,-25.5438214083923],"name":"Lower Bound","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y"},{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22"],"y":[0,-1,1,1,-3,-8,-9,-7,-8,-9,-9,-9,-6,-11,-10,-12,-9,-9,-10,-12,-15,-14,-14,-13,-14,-18,-15,-14,-11,-12,-10,-9,-9,-12,-13,-12,-12,-9,-8,-8,-8,-7,-6,-8,-11,-12,-10,-5,-4,-9,-16,-14,-11,-13,-15,-21,-16,-17,-15,-17],"name":"Actual","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y"}],"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p>So, Prophet believes that President Trump’s approval is degrading basically linearly. More specifically…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prophet_plot_components</span>(m, forecast)</code></pre></div>
<p><img src="TrackingPresTrumpsApprovalRating_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
<p>…From these component plots we can see than there’s a recurring weekly pattern (it seems Sundays and Wednesdays are the best for the President), superimposed over a linear decrease. If you cut the plotly graph above into week-long chunks, you’ll see that they all follow this day-of-week trajectory.</p>
<div id="scoring-the-prophet" class="section level2">
<h2>Scoring the Prophet</h2>
<p>In the Good Judgement Open, one doesn’t really get credit for the binary accuracy of their forecasts. Rather, one is rewarded for minimizing error. So, let’s measure Prophet’s error. To do this, I’m going to use <a href="https://en.wikipedia.org/wiki/Mean_absolute_error">Mean Absolute Error</a>, which is just the arithmetic mean of the absolute value of the differences between the estimates and the empirical values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MAE &lt;-<span class="st"> </span>(temp$y -<span class="st"> </span>forecast[<span class="dv">1</span>:n,]$yhat) %&gt;%
<span class="st">  </span><span class="kw">abs</span>() %&gt;%
<span class="st">  </span><span class="kw">mean</span>()

<span class="kw">tibble</span>(<span class="dt">MAE =</span> MAE) %&gt;%
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:10%;">
<colgroup>
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2.957</td>
</tr>
</tbody>
</table>
<p>So, on average, the Prophet estimate has been off by about 2.96 points. It’s interesting to note that this is within Gallup’s own 3-point margin of error, so refining these predictions for higher accuracy doesn’t make a lot of sense.</p>
</div>
<div id="crunching-out-an-estimate" class="section level2">
<h2>Crunching out an Estimate</h2>
<p>Let’s start again with the base frequency-derived estimates: High ~1%, Middle 93%, Low ~5%. How should I update based on Prophet’s estimate? Well, in all honesty, I don’t know exactly. I don’t know the distribution from which Prophet draws its outcomes (I’m guessing it’s normal). But I don’t believe Prophet has much to find with the amount of data available yet. I could assume the distribution is normal and update my estimates using Bayes’ formula, but the conclusion would be that the low- and middle-band probabilities are both large (&gt;10%), and the high band probability is tiny. But maybe there’s a refinement to our approach which could help.</p>
</div>
</div>
<div id="forecasting-non-derived-signals" class="section level1">
<h1>Forecasting non-derived Signals</h1>
<p>This is a slightly weird forecasting problem, as we’re trying to forecast the outcome of a metric which is derived from two distinct-but-highly-correlated metrics: <em>approval</em>, and <em>disapproval</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(approval ~<span class="st"> </span>disapproval)

ratings %&gt;%
<span class="st">  </span><span class="kw">plot_ly</span>(<span class="dt">x =</span> ~disapproval+<span class="kw">runif</span>(n,-.<span class="dv">3</span>,.<span class="dv">3</span>), <span class="dt">y =</span> ~approval+<span class="kw">runif</span>(n,-.<span class="dv">3</span>,.<span class="dv">3</span>), <span class="dt">type =</span> <span class="st">&quot;scatter&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;Observations&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">add_trace</span>(<span class="dt">x =</span> ~disapproval, <span class="dt">y =</span> ~<span class="kw">fitted</span>(model), <span class="dt">mode =</span> <span class="st">&quot;lines&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;LM&quot;</span>)</code></pre></div>
<div id="htmlwidget-f5d01bdcc0f1e8be2a91" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f5d01bdcc0f1e8be2a91">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"disapproval + runif(n, -0.3, 0.3)"},"yaxis":{"domain":[0,1],"title":"approval + runif(n, -0.3, 0.3)"},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"modeBarButtonsToRemove":["sendDataToCloud"]},"data":[{"x":[45.2911901968997,45.7519242696464,45.0143148457166,45.2835724694654,48.0572913722601,50.2277071057819,50.811526979506,49.8670583853964,50.7545810256153,52.2690966910683,51.8540026329923,52.2192985443864,49.9803856518585,52.7069527568296,51.8084756235126,54.2956590217073,52.2007987433579,51.9788121980615,51.9913313762285,53.2959954953287,54.7732772568241,54.1700683834031,54.1817767114844,53.0749727060087,54.1544655089267,56.2600033379626,54.8825639902614,55.2939275764395,53.2239914366044,52.726627732534,52.2903798276559,51.8447687159292,52.2442091830075,53.1420123762451,54.0278906690888,53.9287460991181,53.771865584515,52.0400287490804,50.7314488755539,51.2848044772167,51.242893220298,49.9971103475429,50.2525636615697,51.1121309731621,52.8472586203367,53.0941480127163,52.0614802489057,48.7614743335173,49.2458666832652,51.1932081942447,54.7339758656919,54.108206286002,53.2018856218085,53.7013220289722,54.8481588015333,57.9308526305016,54.7900204699487,56.0385136654601,54.9643333856948,56.1895074874628],"y":[45.2496849817224,44.722435962595,46.0217911066022,46.2587216904853,45.1010347824544,41.766502692271,42.1595711246598,43.0656796481926,42.8491758381948,43.0631070843898,42.9350136768538,42.7767428179737,43.7539865074214,42.0394894950092,41.9924539173022,41.9585491843522,43.2939058818389,43.015698880516,42.1935969564132,41.1661774674896,39.7236193085089,40.2760821605101,39.9012956175487,39.8508308132645,40.1572970954701,38.2235211971682,40.1879917398561,41.1888530175667,42.1711765050888,41.2057559921406,42.1144702009857,43.0789261834696,42.9058934587054,40.7884605013765,40.894227255974,41.8858714525122,42.1259283066262,43.0453022419009,42.7874063253403,42.8975359924138,43.1274811289273,42.8166945700534,44.1531940414105,43.0337662671227,42.1204042988364,41.2834940613713,42.2475270747207,43.8268795453478,44.8481748294085,42.1159901712555,38.7732599507086,40.2788442613557,42.1825010182802,40.985670891637,39.7468191694003,36.9909134049434,38.8855658340733,39.2803082006983,40.1012605466414,39.1880804980639],"name":"Observations","type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y"},{"x":[45,46,45,45,48,50,51,50,51,52,52,52,50,53,52,54,52,52,52,53,55,54,54,53,54,56,55,55,53,53,52,52,52,53,54,54,54,52,51,51,51,50,50,51,53,53,52,49,49,51,55,54,53,54,55,58,55,56,55,56],"y":[46.5495079950801,45.9060578105781,46.5495079950799,46.5495079950799,44.6191574415744,43.3322570725707,42.6888068880689,43.3322570725707,42.6888068880689,42.045356703567,42.045356703567,42.045356703567,43.3322570725707,41.4019065190652,42.045356703567,40.7584563345633,42.045356703567,42.045356703567,42.045356703567,41.4019065190652,40.1150061500615,40.7584563345633,40.7584563345633,41.4019065190652,40.7584563345633,39.4715559655597,40.1150061500615,40.1150061500615,41.4019065190652,41.4019065190652,42.045356703567,42.045356703567,42.045356703567,41.4019065190652,40.7584563345633,40.7584563345633,40.7584563345633,42.045356703567,42.6888068880689,42.6888068880689,42.6888068880689,43.3322570725707,43.3322570725707,42.6888068880689,41.4019065190652,41.4019065190652,42.045356703567,43.9757072570725,43.9757072570726,42.6888068880689,40.1150061500615,40.7584563345634,41.4019065190652,40.7584563345634,40.1150061500615,38.184655596556,40.1150061500615,39.4715559655597,40.1150061500615,39.4715559655597],"name":"LM","type":"scatter","mode":"lines","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y"}],"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model %&gt;%
<span class="st">  </span><span class="kw">summary</span>() %&gt;%
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:88%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">75.5</td>
<td align="center">1.952</td>
<td align="center">38.69</td>
<td align="center">4.05e-43</td>
</tr>
<tr class="even">
<td align="center"><strong>disapproval</strong></td>
<td align="center">-0.6435</td>
<td align="center">0.03734</td>
<td align="center">-17.23</td>
<td align="center">1.735e-24</td>
</tr>
</tbody>
</table>
<table style="width:86%;">
<caption>Fitting linear model: approval ~ disapproval</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">60</td>
<td align="center">0.7775</td>
<td align="center">0.8366</td>
<td align="center">0.8338</td>
</tr>
</tbody>
</table>
<p>[Note that these points are jittered because scatterplots of integers tend to overplot.]</p>
<p>So, perhaps we can do better by forecasting <em>each</em>, and then deriving the net approval from the forecast. There are good reasons not to do this! Think of a model as an engine. You feed it gasoline (empirical data) and it does work (good predictions), but with an undesirable side effect–it also emits toxic gas (error). By adding a second engine, we may produce twice as many predictions (which <em>doesn’t actually help us</em>), but we’ll also have two error generators (which <em>actually hurts us</em>).</p>
<p>That said, the two streams aren’t perfectly correlated, and this is instructive. One may be acting in a way that is systematically (as opposed to randomly) distinct. Imagine two mobs of people. On the left, people who disapprove of the President. On the right, people who approve of him. Some people will move between the two mobs in response to things that happen. Some people will not. There’s also an amorphous blob of people in the middle who don’t know how they feel, or just don’t feel strongly about the President. Here’s a map of the political blogosphere that somewhat resembles what I’m envisioning:</p>
<div class="figure">
<img src="http://adequatebird.com/wp-content/uploads/2010/05/Figure-1-Community-structure-of-political-blogs-expanded-set.jpg" />

</div>
<p>If people can move between these camps independently (i.e. the decision to move from “approve” to “don’t know” is distinct from the decision to move from “don’t know” to “disapprove”), then maybe forecasting them separately makes sense. Let’s just try it and see.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dApproval &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ds =</span> date, <span class="dt">y =</span> approval)

m &lt;-<span class="st"> </span><span class="kw">prophet</span>(dApproval, <span class="dt">yearly.seasonality =</span> F)</code></pre></div>
<pre><code>## STAN OPTIMIZATION COMMAND (LBFGS)
## init = user
## save_iterations = 1
## init_alpha = 0.001
## tol_obj = 1e-12
## tol_grad = 1e-08
## tol_param = 1e-08
## tol_rel_obj = 10000
## tol_rel_grad = 1e+07
## history_size = 5
## seed = 930371853
## initial log joint probability = -2.06757
## Optimization terminated normally: 
##   Convergence detected: absolute parameter change was below tolerance</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">approvalforecast &lt;-<span class="st"> </span><span class="kw">predict</span>(m, future)

<span class="kw">plot_ly</span>(approvalforecast, <span class="dt">x =</span> ~ds, <span class="dt">y =</span> ~yhat, <span class="dt">name =</span> <span class="st">&quot;Estimate&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="dt">mode =</span> <span class="st">&#39;lines&#39;</span>) %&gt;%
<span class="st">  </span><span class="kw">add_lines</span>(<span class="dt">data =</span> dApproval, <span class="dt">y =</span> ~y, <span class="dt">name =</span> <span class="st">&quot;Actual&quot;</span>)</code></pre></div>
<div id="htmlwidget-9c4dc036684080f4bf11" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9c4dc036684080f4bf11">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"ds"},"yaxis":{"domain":[0,1],"title":"yhat"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"modeBarButtonsToRemove":["sendDataToCloud"]},"data":[{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22","2017-03-23","2017-03-24","2017-03-25","2017-03-26","2017-03-27","2017-03-28","2017-03-29","2017-03-30","2017-03-31","2017-04-01","2017-04-02","2017-04-03","2017-04-04","2017-04-05","2017-04-06","2017-04-07","2017-04-08","2017-04-09","2017-04-10","2017-04-11","2017-04-12","2017-04-13","2017-04-14","2017-04-15","2017-04-16","2017-04-17","2017-04-18","2017-04-19","2017-04-20","2017-04-21","2017-04-22","2017-04-23","2017-04-24","2017-04-25","2017-04-26","2017-04-27","2017-04-28","2017-04-29","2017-04-30","2017-05-01"],"y":[44.7249826099962,44.0941587193059,44.5840743249546,44.6208603248309,44.1313586415144,43.7956220130664,43.2118012456846,43.544523735419,42.9136998784824,43.4036155063056,43.4404015195598,42.9508998496249,42.6151632129599,42.0313424373601,42.364064912952,41.7332410418726,42.2231576311454,42.2599446140942,41.7707172286994,41.4352548780415,40.8823606147285,41.2460095954606,40.720503219271,41.3157363394197,41.5342538249164,41.287178448253,41.1938681063277,40.852897631379,41.4284704004754,41.0404968301285,41.7732627561214,42.0528990778723,41.8062477164348,41.7133613642461,41.3723908731213,41.9479636223021,41.5599900248123,42.2927551259952,42.5723906208552,42.3210375306316,42.2059133556115,41.8427050416553,42.3275233296997,41.8487952710721,42.4090306763959,42.5161364753965,42.0400018779715,41.7176323152836,41.1013369070392,41.40158474284,40.7382862319701,41.1957272174379,41.200038596583,40.678062292537,40.3098510232271,39.6935556149821,39.9938034507828,39.3305049399123,39.7879459253799,39.7922573045245,39.2702810004792,38.9020697311705,38.2857743229254,38.5860221587256,37.9227236478543,38.3801646333228,38.3844760124678,37.8624997084214,37.4942884391123,36.8779930308675,37.1782408666688,36.5149423557985,36.9723833412657,36.9766947204112,36.4547184163635,36.0865071470546,35.4702117388109,35.7704595746116,35.1071610637405,35.5646020492101,35.5689134283544,35.0469371243083,34.6787258549988,34.0624304467538,34.3626782825544,33.6993797716835,34.1568207571505,34.161132136296,33.6391558322499,33.2709445629406,32.6546491546966,32.9548969904973,32.2915984796267,32.749039465095,32.7533508442393,32.2313745401937,31.8631632708841,31.2468678626393,31.5471156984404,30.8838171875699],"name":"Estimate","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y"},{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22"],"y":[45,45,46,46,45,42,42,43,43,43,43,43,44,42,42,42,43,43,42,41,40,40,40,40,40,38,40,41,42,41,42,43,43,41,41,42,42,43,43,43,43,43,44,43,42,41,42,44,45,42,39,40,42,41,40,37,39,39,40,39],"name":"Actual","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y"}],"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p>Here is Prophet’s estimate of the Approval rating. It’s trending downward.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dDisapproval &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ds =</span> date, <span class="dt">y =</span> disapproval)

m &lt;-<span class="st"> </span><span class="kw">prophet</span>(dDisapproval, <span class="dt">yearly.seasonality =</span> F)</code></pre></div>
<pre><code>## STAN OPTIMIZATION COMMAND (LBFGS)
## init = user
## save_iterations = 1
## init_alpha = 0.001
## tol_obj = 1e-12
## tol_grad = 1e-08
## tol_param = 1e-08
## tol_rel_obj = 10000
## tol_rel_grad = 1e+07
## history_size = 5
## seed = 934513820
## initial log joint probability = -2.11271
## Optimization terminated normally: 
##   Convergence detected: absolute parameter change was below tolerance</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">disapprovalforecast &lt;-<span class="st"> </span><span class="kw">predict</span>(m, future)

<span class="kw">plot_ly</span>(disapprovalforecast, <span class="dt">x =</span> ~ds, <span class="dt">y =</span> ~yhat, <span class="dt">name =</span> <span class="st">&quot;Estimate&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="dt">mode =</span> <span class="st">&#39;lines&#39;</span>) %&gt;%
<span class="st">  </span><span class="kw">add_lines</span>(<span class="dt">data =</span> dDisapproval, <span class="dt">y =</span> ~y, <span class="dt">name =</span> <span class="st">&quot;Actual&quot;</span>)</code></pre></div>
<div id="htmlwidget-2e7e76fd6c98a0971f2d" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2e7e76fd6c98a0971f2d">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"ds"},"yaxis":{"domain":[0,1],"title":"yhat"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"modeBarButtonsToRemove":["sendDataToCloud"]},"data":[{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22","2017-03-23","2017-03-24","2017-03-25","2017-03-26","2017-03-27","2017-03-28","2017-03-29","2017-03-30","2017-03-31","2017-04-01","2017-04-02","2017-04-03","2017-04-04","2017-04-05","2017-04-06","2017-04-07","2017-04-08","2017-04-09","2017-04-10","2017-04-11","2017-04-12","2017-04-13","2017-04-14","2017-04-15","2017-04-16","2017-04-17","2017-04-18","2017-04-19","2017-04-20","2017-04-21","2017-04-22","2017-04-23","2017-04-24","2017-04-25","2017-04-26","2017-04-27","2017-04-28","2017-04-29","2017-04-30","2017-05-01"],"y":[46.3844689954301,47.729852819846,47.2847859539148,47.5183920856705,48.3147595820615,48.4508935927035,49.8339255460272,49.1656921328288,50.511075965671,50.0586916459267,50.2731845362132,51.0504387911268,51.1357383620614,52.4679358756796,51.7273857602601,53.000452890881,52.4306855453905,52.5395911972719,53.148817778283,53.0978108830767,54.2138798971457,53.2786835270542,54.2681181353315,53.4671020532637,53.2722563355828,53.5757995401716,53.2191092685414,54.0936921147707,52.9170095768398,53.7539399514474,52.8004196357059,52.5255723165402,52.8134863619998,52.4411669318421,53.3157454443698,52.1390585690642,52.9759889397976,52.022468621485,51.7476213005424,52.0355355070032,51.6632257523303,52.5378139403435,51.4504352376766,52.3766737810524,51.6182573480089,51.5385139123375,52.1132863117987,52.027825235043,53.2930624857098,52.5070343522163,53.7346234647622,53.1717618869627,53.2875733065333,53.966146090734,53.9844853987183,55.2497226493861,54.4636945158927,55.6912836284403,55.1284220506402,55.2442334702126,55.9228062544112,55.9411455623936,57.2063828130617,56.4203546795692,57.6479437921184,57.0850822143169,57.2008936338879,57.8794664180884,57.8978057260718,59.1630429767389,58.3770148432446,59.6046039557916,59.0417423779935,59.1575537975631,59.8361265817657,59.8544658897494,61.1197031404144,60.333675006921,61.5612641194697,60.9984025416668,61.1142139612386,61.7927867454388,61.811126053423,63.0763633040907,62.2903351705974,63.5179242831454,62.9550627053477,63.0708741249176,63.7494469091186,63.7677862171011,65.033023467767,64.2469953342738,65.474584446821,64.9117228690209,65.0275342885928,65.7061070727925,65.7244463807765,66.9896836314435,66.2036554979493,67.4312446104966],"name":"Estimate","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y"},{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22"],"y":[45,46,45,45,48,50,51,50,51,52,52,52,50,53,52,54,52,52,52,53,55,54,54,53,54,56,55,55,53,53,52,52,52,53,54,54,54,52,51,51,51,50,50,51,53,53,52,49,49,51,55,54,53,54,55,58,55,56,55,56],"name":"Actual","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y"}],"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p>And here is Prophet’s estimate of the Disapproval rating. It’s trending upward. So, now if we combine the two…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">temp &lt;-<span class="st"> </span>approvalforecast %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">approval =</span> yhat) %&gt;%
<span class="st">  </span><span class="kw">cbind</span>(<span class="dt">disapproval =</span> disapprovalforecast$yhat) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">net =</span> approval -<span class="st"> </span>disapproval)

<span class="kw">plot_ly</span>(temp, <span class="dt">x =</span> ~ds, <span class="dt">y =</span> ~net, <span class="dt">name =</span> <span class="st">&quot;Estimate&quot;</span>, <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="dt">mode =</span> <span class="st">&#39;lines&#39;</span>) %&gt;%
<span class="st">  </span><span class="kw">add_lines</span>(<span class="dt">data =</span> ratings, <span class="dt">x =</span> ~date, <span class="dt">y =</span> ~net_approval, <span class="dt">name =</span> <span class="st">&quot;Actual&quot;</span>)</code></pre></div>
<div id="htmlwidget-666eab7e49a1a567de32" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-666eab7e49a1a567de32">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"ds"},"yaxis":{"domain":[0,1],"title":"net"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"modeBarButtonsToRemove":["sendDataToCloud"]},"data":[{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22","2017-03-23","2017-03-24","2017-03-25","2017-03-26","2017-03-27","2017-03-28","2017-03-29","2017-03-30","2017-03-31","2017-04-01","2017-04-02","2017-04-03","2017-04-04","2017-04-05","2017-04-06","2017-04-07","2017-04-08","2017-04-09","2017-04-10","2017-04-11","2017-04-12","2017-04-13","2017-04-14","2017-04-15","2017-04-16","2017-04-17","2017-04-18","2017-04-19","2017-04-20","2017-04-21","2017-04-22","2017-04-23","2017-04-24","2017-04-25","2017-04-26","2017-04-27","2017-04-28","2017-04-29","2017-04-30","2017-05-01"],"y":[-1.65948638543392,-3.63569410054009,-2.70071162896025,-2.89753176083958,-4.1834009405471,-4.65527157963709,-6.62212430034265,-5.62116839740982,-7.59737608718866,-6.65507613962113,-6.83278301665334,-8.09953894150192,-8.52057514910152,-10.4365934383195,-9.36332084730815,-11.2672118490084,-10.2075279142451,-10.2796465831777,-11.3781005495836,-11.6625560050353,-13.3315192824171,-12.0326739315936,-13.5476149160605,-12.151365713844,-11.7380025106664,-12.2886210919186,-12.0252411622137,-13.2407944833917,-11.4885391763644,-12.7134431213189,-11.0271568795845,-10.4726732386679,-11.007238645565,-10.727805567596,-11.9433545712485,-10.1910949467621,-11.4159989149854,-9.72971349548981,-9.17523067968713,-9.71449797637158,-9.45731239671876,-10.6951088986882,-9.1229119079769,-10.5278785099802,-9.209226671613,-9.02237743694102,-10.0732844338272,-10.3101929197594,-12.1917255786706,-11.1054496093763,-12.9963372327921,-11.9760346695247,-12.0875347099503,-13.2880837981969,-13.6746343754913,-15.5561670344041,-14.4698910651099,-16.3607786885279,-15.3404761252603,-15.4519761656882,-16.652525253932,-17.0390758312231,-18.9206084901362,-17.8343325208435,-19.725220144264,-18.7049175809941,-18.81641762142,-20.0169667096671,-20.4035172869594,-22.2850499458713,-21.1987739765758,-23.0896615999931,-22.0693590367278,-22.1808590771519,-23.3814081654022,-23.7679587426948,-25.6494914016035,-24.5632154323094,-26.4541030557292,-25.4338004924566,-25.5453005328842,-26.7458496211305,-27.1324001984242,-29.0139328573369,-27.927656888043,-29.8185445114619,-28.7982419481972,-28.9097419886216,-30.1102910768687,-30.4968416541605,-32.3783743130704,-31.2920983437765,-33.1829859671943,-32.162683403926,-32.2741834443535,-33.4747325325988,-33.8612831098924,-35.7428157688042,-34.6565397995089,-36.5474274229267],"name":"Estimate","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y"},{"x":["2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22"],"y":[0,-1,1,1,-3,-8,-9,-7,-8,-9,-9,-9,-6,-11,-10,-12,-9,-9,-10,-12,-15,-14,-14,-13,-14,-18,-15,-14,-11,-12,-10,-9,-9,-12,-13,-12,-12,-9,-8,-8,-8,-7,-6,-8,-11,-12,-10,-5,-4,-9,-16,-14,-11,-13,-15,-21,-16,-17,-15,-17],"name":"Actual","mode":"lines","type":"scatter","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y"}],"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p>We have another estimate. But is it an improvement?</p>
<div id="scoring-the-prophet-round-2" class="section level2">
<h2>Scoring the Prophet, Round 2</h2>
<p>Let’s look at the same scoring metric (Mean Absolute Error) to see if the approval-disapproval models fit the data better than the net_approval model. (The lower MAE indicates a better fit.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MAE &lt;-<span class="st"> </span>(ratings$net_approval -<span class="st"> </span>temp[<span class="dv">1</span>:n,]$net) %&gt;%
<span class="st">  </span><span class="kw">abs</span>() %&gt;%
<span class="st">  </span><span class="kw">mean</span>()

<span class="kw">tibble</span>(<span class="dt">MAE =</span> MAE) %&gt;%
<span class="st">  </span><span class="kw">pander</span>()</code></pre></div>
<table style="width:10%;">
<colgroup>
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.897</td>
</tr>
</tbody>
</table>
<p>So, a full point lower than the single-model approach. At this point, it looks like modeling approval and disapproval separately is probably the better way to go, increasing the fit of the model. Ordinarily, I’d test this with some cross-validation procedure(s), but we’re still working with so little data that cross-validation is difficult.</p>
<p>Extrapolating from these trends, we have a prediction that by the end of the GJO’s question lifecycle, the net Approval rating will be around -20. This, coincidentally, is what we should predict from our very most blunt approach of predicting what today’s value is for every point in the future. Accordingly, we should place a lot of confidence in the lower-band probability, some in the middle band, and almost none in the upper band.</p>
<p>I should be able to derive more precise estimates (i.e. real numbers) from this model, but (again) I don’t know enough about the distribution Prophet outputs, so I don’t know how to properly combine the given margins to estimate the distribution of the estimate for the date in question. Just glancing at the margins suggests that Prophet estimates that the middle band covers the upper 20% of outcomes, so there’s an 80% likelihood that the net approval will be in the lower band. Accordingly, my current estimate for the GJO is Low: 80, Mid: 19, Hi: 1.</p>
<p>This is a bold claim, relative to the <a href="https://www.gjopen.com/questions/384-what-will-gallup-report-president-trump-s-net-approval-rating-to-be-on-28-april-2017/stats">GJO consensus</a>:</p>
<div class="figure">
<img src="http://anthony.boyles.cc/imgs/Screenshot_2017-03-16_10-49-06.png" />

</div>
<p>Here we can see that my estimate and the consensus are approximately opposites between the low and middle bands, while agreeing that the probability of the high band is vanishingly small. I’d normally be much more conservative with my estimate, but…</p>
</div>
</div>
<div id="the-inside-view" class="section level1">
<h1>The Inside View</h1>
<p>…<a href="http://www.vox.com/world/2017/3/20/14982018/comey-fbi-investigation-russia-trump-campaign">isn’t good for the President</a>.</p>
</div>
</div>


</div>

<div id="postamble" data-toggle="wy-nav-shift" class="status">
</div>


<script>
$(document).ready(function () {
 	  });
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
