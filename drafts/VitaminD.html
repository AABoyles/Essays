<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Vitamin D</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="site_libs/style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Anthony A. Boyles</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Portfolio</a>
</li>
<li>
  <a href="../essays/">Essays</a>
</li>
<li>
  <a href="../code.html">Code</a>
</li>
<li>
  <a href="../about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../README.html">Meta</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Vitamin D</h1>

</div>


<pre class="r"><code>library(&quot;htmltab&quot;)
library(&quot;magrittr&quot;)
library(&quot;plyr&quot;)
library(&quot;tidyverse&quot;)
library(&quot;plotly&quot;)
library(&quot;intubate&quot;)
library(&quot;knitr&quot;)
library(&quot;metafor&quot;)
library(&quot;BayesianFirstAid&quot;)
library(&quot;bayesmeta&quot;)
knitr::opts_chunk$set(message = FALSE, warning = FALSE, error = FALSE)
load(&#39;../data-cache/Longevity.RData&#39;)</code></pre>
<pre class="r"><code>source(&quot;infobox.R&quot;)
infobox(list(
  &quot;Status&quot; = &quot;Incomplete&quot;,
  &quot;Epistemic Status&quot; = &quot;Speculative&quot;,
  &quot;Fork of&quot; = tags$a(href=&#39;http://www.gwern.net/Longevity&#39;, &quot;Gwern&#39;s Longevity&quot;),
  &quot;First Revision&quot; = &quot;2016-10-14&quot;,
  &quot;Last Revision&quot; = as.Date(file.info(&quot;drafts/Longevity.Rmd&quot;)$mtime)
))</code></pre>
<div class="infobox">
<table class="infoboxtable table table-striped">
<tbody>
<tr>
<td>
<b>Status</b>
</td>
<td>Incomplete</td>
</tr>
<tr>
<td>
<b>Epistemic Status</b>
</td>
<td>Speculative</td>
</tr>
<tr>
<td>
<b>Fork of</b>
</td>
<td>
<a href="http://www.gwern.net/Longevity">Gwern's Longevity</a>
</td>
</tr>
<tr>
<td>
<b>First Revision</b>
</td>
<td>2016-10-14</td>
</tr>
<tr>
<td>
<b>Last Revision</b>
</td>
<td>NA</td>
</tr>
</tbody>
<tfoot></tfoot>
</table>
</div>
<p>A review of vitamin D meta-analyses reporting on all-cause mortality yields a meta-analytic result of <span class="math inline">\(RR\approx0.96\)</span> with little heterogeneity or signs of bias. Reproducing it as a Bayesian random-effects meta-analysis gives an 84% posterior predictive probability that <span class="math inline">\(RR&lt;1.0\)</span>. The expected life expectancy gain is 0.33 years or $16,800, while total cost of vitamin D supplementation is estimated at $761, for a profit of $15,300. The probability of being profitable is estimated to be 83%. The optimal age at which to begin supplementation is 24 years old.</p>
<div id="background" class="section level2">
<h2>Background</h2>
<p>Vitamins D2 and D3 have been researched intensively ever since their discovery for possible benefits for a range of problems, starting with rickets and expanding from there to everything under the sun. Interest in vitamin D is sparked by many correlational results showing low levels of vitamin D in modern Western populations (unsurprising, given how little time people spend in the sun compared to historically) and how low levels correlate and predict with all sorts of bad things - particularly all-cause mortality.</p>
<p>The downside is that the literature is so large and heterogeneous that it’s hard to deal with and for many of the uses investigated, there is conflicting evidence. We are fortunate, however: the large research area of bone fractures/<a href="http://en.wikipedia.org/wiki/Falls%20in%20older%20adults" title="Wikipedia: Falls in older adults">falls</a>/osteoporosis in the elderly (collectively, leading causes of death &amp; disability) means many (relatively) large RCTs in (relatively) healthy people are available with meaningful death rates reported. For particularly comprehensive reviews, see <a href="https://www.ncbi.nlm.nih.gov/books/NBK253540/" title="Vitamin D and Calcium: A Systematic Review of Health Outcomes (Update)">Newberry et al 2014</a> and <a href="http://www.bmj.com/content/348/bmj.g2035.full" title="Vitamin D and multiple health outcomes: umbrella review of systematic reviews and meta-analyses of observational studies and randomised trials">Theodoratou et al 2014</a>.</p>
<p>In addition, vitamin D3 also has considerable plausibility for being profitable: it can be taken in extremely large doses (&gt;10-100x normal daily doses) without much sign of toxicity (leading to a fair number of trials which ensure compliance by just injecting mega-doses of vitamin D every month or year), <a href="http://en.wikipedia.org/wiki/hypervitaminosis%20D">hypervitaminosis D</a> is rare and not usually fatal, side-effects are rare and minimal, it is already taken by many millions of healthy and sick people without noticeable problems, and vitamin D costs ~$15/year.</p>
</div>
<div id="causality" class="section level2">
<h2>Causality</h2>
<div id="meta-analyses" class="section level3">
<h3>Meta Analyses</h3>
<p>The overall thrust of the meta-analyses is that there is consistent and substantial evidence that regular vitamin D3 supplementation reduces all-cause mortality somewhere in the RR=0.90-1 range, that vitamin D2 may be worse but calcium seems irrelevant, and this effect seems to be general: the observable between-study heterogeneity is very small despite large differences in subject populations by gender, age, and dosage, and subgroup analyses do not find the effect confined to particular demographics or that a reduction in a particular disease is driving the ACM reduction (which while potentially due to lack of power, would be consistent with the generality of benefits in both the correlational and Mendelian randomization studies).</p>
<p>The most comprehensive meta-analysis by my count is Bolland et al 2014, which pools <em>k</em>=41 to get an estimate of RR 0.96 (0.93-1.00; <em>p</em>=0.04) based on an experimental death rate of 3824/40379=0.0947 vs control death rate of 3950/40794=0.0968. The meta-analysis itself can be reproduced given Bolland’s forest plot &amp; table, Figure 5.</p>
<pre class="r"><code>vitaminD &lt;- data.frame(
  &quot;Study&quot;= c(&quot;Inkovaara&quot;, &quot;Corless&quot;, &quot;Ooms&quot;, &quot;Lips A&quot;, &quot;Komulainen&quot;, &quot;Meyer&quot;, &quot;Bischoff&quot;, &quot;Cooper&quot;, &quot;Latham&quot;, &quot;Trivedi&quot;, &quot;Avenell&quot;, &quot;Harwood&quot;, &quot;Aloia&quot;, &quot;Flicker&quot;, &quot;Grant&quot;, &quot;Broe&quot;, &quot;Burleigh&quot;, &quot;Lappe&quot;, &quot;Lyons&quot;, &quot;Smith&quot;, &quot;Björkman&quot;, &quot;Chel&quot;, &quot;Prince&quot;, &quot;Zhu&quot;, &quot;Lips B&quot;, &quot;Sanders&quot;, &quot;Glendenning&quot;, &quot;Inkovaara&quot;, &quot;Chapuy A&quot;, &quot;Dawson-Hughes&quot;, &quot;Baeksgaard&quot;, &quot;Krieg&quot;, &quot;Chapuy B&quot;, &quot;Harwood&quot;, &quot;Meier&quot;, &quot;Brazier&quot;, &quot;Grant&quot;, &quot;Porthouse&quot;, &quot;WHI trials&quot;, &quot;Bolton-Smith&quot;, &quot;Zhu&quot;, &quot;Salovaara&quot;),
 &quot;Year&quot;=c(1983, 1985, 1995, 1996, 1998, 2002, 2003, 2003, 2003, 2003, 2004, 2004, 2005, 2005, 2005, 2007, 2007, 2007, 2007, 2007, 2008, 2008, 2008, 2008, 2010, 2010, 2012, 1983, 1992, 1997, 1998, 1999, 2002, 2004, 2004, 2005, 2005, 2005, 2006, 2007, 2008, 2010),
  &quot;E.deaths&quot;=c(41, 8, 11, 223, 2, 169, 1, 0, 11, 224, 4, 24, 1, 76, 438, 5, 16, 4, 947, 355, 27, 25, 0, 0, 1, 40, 2, 2, 258, 2, 0, 21, 70, 17, 0, 3, 221, 57, 744, 0, 0, 15),
  &quot;E.n&quot;=c(181, 41, 177, 1291, 232, 569, 62, 93, 121, 1345, 70, 113, 104, 313, 2649, 99, 101, 446, 1725, 4727, 150, 166, 151, 39, 114, 1131, 353, 353, 1634, 187, 80, 124, 389, 75, 30, 95, 1306, 1321, 18176, 62, 39, 1718),
  &quot;C.deaths&quot;=c(26, 8, 21, 251, 2, 163, 4, 1, 3, 247, 3, 5, 2, 85, 460, 2, 13, 18, 953, 354, 9, 33, 1, 2, 0, 47, 0, 0, 274, 2, 1, 26, 43, 5, 1, 1, 217, 68, 807, 1, 2, 13),
  &quot;C.n&quot;=c(146, 41, 171, 1287, 232, 575, 60, 94, 122, 1341, 64, 37, 104, 312, 2643, 25, 104, 734, 1715, 4713, 68, 172, 151, 81, 112, 1125, 333, 333, 1636, 202, 80, 124, 194, 37, 25, 97, 1332, 1993, 18106, 61, 41, 1714),
  &quot;Calcium&quot;=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
)

rma(measure=&quot;RR&quot;, ai=E.deaths, bi=(E.n-E.deaths), ci=C.deaths, di=(C.n-C.deaths), data=vitaminD, method=&quot;REML&quot;)</code></pre>
<pre><code>## 
## Random-Effects Model (k = 42; tau^2 estimator: REML)
## 
## tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.0015)
## tau (square root of estimated tau^2 value):      0
## I^2 (total heterogeneity / total variability):   0.00%
## H^2 (total variability / sampling variability):  1.00
## 
## Test for Heterogeneity: 
## Q(df = 41) = 36.5200, p-val = 0.6699
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub   
##  -0.0354  0.0186  -1.8990  0.0576  -0.0719  0.0011  .
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Since I^2=0, this is equivalent to a fixed-effect meta-analysis:</p>
<pre class="r"><code>rma(measure=&quot;RR&quot;, ai=E.deaths, bi=(E.n-E.deaths), ci=C.deaths, di=(C.n-C.deaths), data=vitaminD, method=&quot;FE&quot;)</code></pre>
<pre><code>## 
## Fixed-Effects Model (k = 42)
## 
## Test for Heterogeneity: 
## Q(df = 41) = 36.5200, p-val = 0.6699
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub   
##  -0.0354  0.0186  -1.8990  0.0576  -0.0719  0.0011  .
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>(Oddly, the per-study mortality rates in the Bolland forest plot/table don’t add up to the claimed totals, but are short by a few dozen each; since the RR calculated by <code>metafor</code> works out to be about the same, I assume it has something to do with how Bolland decided to handle including multiple subgroups from studies and is not important.)</p>
<p>Turning from frequentist to Bayesian methods, we could take the fixed-effect at face-value and use a Bayesian proportion test, for example:</p>
<pre class="r"><code>bayes.prop.test(c(sum(vitaminD$E.deaths), sum(vitaminD$C.deaths)), c(sum(vitaminD$E.n), sum(vitaminD$C.n)))</code></pre>
<pre><code>## 
##  Bayesian First Aid proportion test
## 
## data: c(sum(vitaminD$E.deaths), sum(vitaminD$C.deaths)) out of c(sum(vitaminD$E.n), sum(vitaminD$C.n))
## number of successes:   4065,  4174
## number of trials:     42152, 42537
## Estimated relative frequency of success [95% credible interval]:
##   Group 1: 0.096 [0.094, 0.099]
##   Group 2: 0.098 [0.095, 0.10]
## Estimated group difference (Group 1 - Group 2):
##   0 [-0.0058, 0.0022]
## The relative frequency of success is larger for Group 1 by a probability
## of 0.207 and larger for Group 2 by a probability of 0.793 .</code></pre>
<p>Using BFA has the downside that an I^2=0 doesn’t guarantee that there is no heterogeneity (it’d be surprising if there wasn’t) and gives an overly narrow predictive distribution, and BFA doesn’t easily include our informative priors. We can switch to <a href="https://cran.r-project.org/web/packages/bayesmeta/index.html">bayesmeta</a> which is easier to use than JAGS since it’s built on metafor:</p>
<pre class="r"><code>brem &lt;- escalc(measure=&quot;RR&quot;, ai=E.deaths, bi=(E.n-E.deaths), ci=C.deaths, di=(C.n-C.deaths), data=vitaminD) %&gt;%
          bayesmeta(mu.prior.mean=0, mu.prior.sd=0.35^2)
brem</code></pre>
<pre><code>##  &#39;bayesmeta&#39; object.
## 
## 42 estimates:
## 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, ...
## 
## tau prior (improper):
## uniform(min=0, max=Inf) 
## 
## mu prior (proper):
## normal(mean=0, sd=0.1225)
## 
## ML and MAP estimates:
##                     tau          mu
## ML joint     0.0000e+00 -0.03540162
## ML marginal  0.0000e+00 -0.03698009
## MAP joint    2.5032e-06 -0.03459976
## MAP marginal 0.0000e+00 -0.03590425
## 
## marginal posterior summary:
##                  tau           mu
## mode      0.00000000 -0.035904247
## median    0.02518174 -0.036071256
## mean      0.03104984 -0.036155194
## sd        0.02543032  0.022517675
## 95% lower 0.00000000 -0.080764905
## 95% upper 0.07999854  0.008121997
## 
## (quoted intervals are shortest credible intervals.)</code></pre>
<p>Converting from log RRs to RR:</p>
<pre class="r"><code>exp(c(-0.080152143106, -0.036152849917, 0.008768546338))</code></pre>
<pre><code>## [1] 0.9229759 0.9644929 1.0088071</code></pre>
<p>Posterior predictive distribution of RR values including heterogeneity</p>
<pre class="r"><code>rrPP &lt;- exp(brem$rposterior(1000, predict=TRUE)[,2])</code></pre>
<p>Probability that vitamin D will reduce all-cause mortality in unobserved populations:</p>
<pre class="r"><code>sum(rrPP&lt;1) / length(rrPP)</code></pre>
<pre><code>## [1] 0.852</code></pre>
</div>
</div>
<div id="benefit" class="section level2">
<h2>Benefit</h2>
<p>Expected life expectancy increase:</p>
<pre class="r"><code>RR &lt;- mean(rrPP)
years &lt;- mean(sapply(rrPP, lifeExpectancyGain))
years * valueOfDALY</code></pre>
<pre><code>## [1] 15739.78</code></pre>
<p>Hence, vitamin D supplementation could be worth &lt;=$16.8k.</p>
</div>
<div id="cost" class="section level2">
<h2>Cost</h2>
<div id="financial" class="section level3">
<h3>Financial</h3>
<p>The meta-analyses do not have anything remotely near a consensus about dosage (nor do the correlational studies, despite much ink spilled), so it probably does not matter much. I have in the past purchased 360x5000IU vitamin D3 pills for <a href="http://amazon.com/gp/product/B0050MYHBQ/?tag=gwernnet-20" title="Doctor&#39;s Best Vitamin D3 5000iu Soft-gels, 360">$10.99</a>, for an annual cost of $11.14. Taking a single pill takes perhaps a sixth of a minute, which again we value at $8/hr. So if we began taking at age 30:</p>
<pre class="r"><code>moneyCost &lt;- (10.99 / 360) * 365
timeCost &lt;- ((1/10)/60) * 365.25 * 8
vitaminDAnnualCost &lt;- moneyCost + timeCost
vitaminDTotalCost &lt;- vitaminDAnnualCost * lifeExpectancy(RR, 30, Inf)
vitaminDTotalCost</code></pre>
<pre><code>## [1] 760.3527</code></pre>
<div id="dosage" class="section level4">
<h4>Dosage</h4>
<p>To go into some more detail about the dosing issue, ne of the more recent meta-analyses to discuss dose in connection with all-cause mortality, <a href="http://www.gwern.net/docs/vitamind/2014-autier.pdf">Autier 2014</a>, says</p>
<blockquote>
<p>…Results of meta-analyses and pooled analyses consistently showed that supplementation could significantly reduce the risk of all-cause mortality, with relative risks ranging from 0.93 to 0.96 (table 4). Most trials included elderly women and a sizeable proportion of individuals were living in institutions. Decreases in risks of death were not associated with trial duration and baseline 25(OH)D concentration. Mortality reductions in trials that used doses of 10-20 μg [400-800IU] per day of vitamin D seemed greater than were reductions noted with higher doses.(13,14)</p>
<ul>
<li>13. Bjelakovic G, Gluud LL, Nikolova D, et al. “Vitamin D supplementation for prevention of mortality in adults”. Cochrane Database Syst Rev 2011; 7: CD007470. [<a href="http://onlinelibrary.wiley.com/doi/10.1002/14651858.CD007469.pub2/pdf">2014</a> update]</li>
<li>14. Rejnmark L, Avenell A, Masud T, et al. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3410276/">“Vitamin D with calcium reduces mortality: patient level pooled analysis of 70,528 patients from eight major vitamin D trials”</a>. J Clin Endocrinol Metab 2012; 97: 2670-81.</li>
</ul>
</blockquote>
<p>(1μg=40IU, so 10μg=400IU, 20μg=800IU, and 1250μg=5000IU.)</p>
<p>I’m not sure I agree. The mechanistic theory and correlations do not predict that 400IU is ideal, it doesn’t seem enough to get blood serum levels of 25(OH)D particularly higher, and I don’t read Rejnmark the same way: the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3410276/figure/F3/">Figure 3 forest plot</a>, to me, shows that after correcting for Smith’s use of D2 rather than D3 (D2 usually performs worse), that there are too few studies using higher doses to make any kind of claim (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3410276/table/T1/">Table 1</a>; almost all the daily studies use &lt;=20μg), and the studies which we do have tend to point to higher being better within this restricted range of dosages.</p>
<p>That said, I cannot prove that 5k IU is equally or more effective, so if anyone is feeling risk-averse or dubious on that score, they should stick with 800IU doses.</p>
<p>A year of daily 800IU doses costs almost the same as higher IU dosages since the vitamin D itself is only a small part of the cost of manufacturing. Alternately, if one is unconcerned about the different between daily and more intermittent doses (reasoning that due to the fat-solubility it should not make any difference), one could take a 5k IU dose on a weekly basis, thereby cutting the annual dose cost from ~$11 to ~$2.</p>
</div>
</div>
<div id="side-effects" class="section level3">
<h3>Side-effects</h3>
<p>Due to rarity, effectively zero: the listed side-effects are all so rare or minor that I can’t come up with any reasonable estimate of cost.</p>
</div>
</div>
<div id="cost-benefit" class="section level2">
<h2>Cost-benefit</h2>
<p>Bringing it all together for a 30yo considering vitamin D:</p>
<pre class="r"><code>benefit &lt;- lifeExpectancyGain(RR, startingAge=30) * valueOfDALY
cost &lt;- vitaminDTotalCost
benefit - cost</code></pre>
<pre><code>## [1] 14255</code></pre>
<div id="optimal-age" class="section level3">
<h3>Optimal age</h3>
<pre class="r"><code>ages &lt;- sapply(1:120, function(startingAge) profitByAge(startingAge, RR, annualCost = vitaminDAnnualCost, startCost = 0, probabilityPenalty=1))
optimalAge &lt;- which.max(ages)</code></pre>
<p>So the optimal age turns out to be around 25.</p>
</div>
<div id="sensitivity" class="section level3">
<h3>Sensitivity</h3>
<p>What RR would wipe out the gains from vitamin D, and how likely is an RR that pessimistic?</p>
<pre class="r"><code>zeroRR &lt;- costToRR(startingAge=optimalAge, annualCost=vitaminDAnnualCost)
sum(rrPP&lt;zeroRR) / length(rrPP)</code></pre>
<pre><code>## [1] 0.844</code></pre>
<p>The window of unprofitability is so narrow that it doesn’t much change the probability.</p>
</div>
</div>
<div id="links-for-future-investigation" class="section level1">
<h1>Links for Future Investigation</h1>
<ul>
<li><a href="http://slatestarcodex.com/2014/01/25/beware-mass-produced-medical-recommendations/">Scott Alexander Thinks Vitamin D3 Supplementation is Bad</a></li>
</ul>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-109466857-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-109466857-1');
</script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
